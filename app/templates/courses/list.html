{% extends "base.html" %}
{% block title %}课程管理{% endblock %}
{% block content %}
  <div class="page-header">
    <div>
      <div class="page-title">课程管理</div>
      <div class="page-subtitle">按教师、班级筛选课程，并维护课程资料。</div>
    </div>
    <a class="btn btn-primary" href="{{ url_for('courses.create_course') }}">新增课程</a>
  </div>

  <form class="filter-panel" method="get">
    <div class="filter-grid">
      <div class="filter-field">
        <label class="form-label" for="teacher_id">授课教师</label>
        <select class="form-select" id="teacher_id" name="teacher_id">
          <option value="">全部教师</option>
          {% for teacher in teachers %}
            <option value="{{ teacher.id }}" {% if teacher_id == teacher.id %}selected{% endif %}>{{ teacher.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="filter-field">
        <label class="form-label" for="class_id">所属班级</label>
        <select class="form-select" id="class_id" name="class_id">
          <option value="">全部班级</option>
          {% for classroom in classes %}
            <option value="{{ classroom.id }}" {% if class_id == classroom.id %}selected{% endif %}>{{ classroom.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div class="filter-actions">
      <button type="submit" class="btn btn-primary">应用筛选</button>
      <a class="btn btn-link" href="{{ url_for('courses.list_courses') }}">重置</a>
    </div>
  </form>

  <div class="grid grid--two">
    {% for course in courses %}
      <section class="card course-card">
        <div class="card-body">
          <div class="course-card__header">
            <h2 class="course-card__title"><a href="{{ url_for('courses.course_detail', course_id=course.id) }}">{{ course.name }}</a></h2>
            <span class="badge">编号 {{ course.code }}</span>
          </div>
          <ul class="course-meta">
            <li><span>学分</span>{{ course.credit }}</li>
            <li><span>授课教师</span>{{ course.teacher.name if course.teacher else '待定' }}</li>
            <li><span>所属班级</span>{{ course.classroom.name if course.classroom else '未关联' }}</li>
          </ul>
          {% if course.description %}
            <p class="course-card__desc">{{ course.description }}</p>
          {% endif %}
          <div class="course-card__actions">
            <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('courses.edit_course', course_id=course.id) }}">编辑</a>
            <a class="btn btn-outline-primary btn-sm" href="{{ url_for('courses.manage_schedule', course_id=course.id) }}">课表</a>
            <a class="btn btn-outline-primary btn-sm" href="{{ url_for('courses.assign_students', course_id=course.id) }}">选课学生</a>
          </div>
        </div>
      </section>
    {% else %}
      <div class="empty-state">暂无课程信息</div>
    {% endfor %}
  </div>
{% endblock %}
