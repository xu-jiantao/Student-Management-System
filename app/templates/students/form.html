{% extends "base.html" %}
{% set is_edit = student is defined %}
{% block title %}{{ '编辑学生' if is_edit else '新增学生' }}{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">{{ '编辑学生信息' if is_edit else '新增学生信息' }}</h1>
    <a class="btn btn-outline-secondary" href="{{ url_for('students.list_students') }}">返回列表</a>
  </div>
  <form method="post" enctype="multipart/form-data" class="row g-3">
    <div class="col-md-4">
      <label class="form-label" for="student_number">学号</label>
      <input type="text" class="form-control" id="student_number" name="student_number" value="{{ student.student_number if is_edit else '' }}" required>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="name">姓名</label>
      <input type="text" class="form-control" id="name" name="name" value="{{ student.name if is_edit else '' }}" required>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="gender">性别</label>
      <select class="form-select" id="gender" name="gender" required>
        <option value="">请选择</option>
        <option value="男" {% if is_edit and student.gender == '男' %}selected{% endif %}>男</option>
        <option value="女" {% if is_edit and student.gender == '女' %}selected{% endif %}>女</option>
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="date_of_birth">出生日期</label>
      <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" value="{{ student.date_of_birth.strftime('%Y-%m-%d') if is_edit and student.date_of_birth else '' }}" required>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="class_id">班级</label>
      <select class="form-select" id="class_id" name="class_id" required>
        <option value="">请选择班级</option>
        {% for classroom in classes %}
          <option value="{{ classroom.id }}" {% if is_edit and student.class_id == classroom.id %}selected{% endif %}>{{ classroom.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="email">邮箱</label>
      <input type="email" class="form-control" id="email" name="email" value="{{ student.email if is_edit else '' }}" required>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="phone">联系电话</label>
      <input type="text" class="form-control" id="phone" name="phone" value="{{ student.phone if is_edit else '' }}" required>
    </div>
    <div class="col-md-4">
      <label class="form-label" for="guardian_name">监护人姓名</label>
      <input type="text" class="form-control" id="guardian_name" name="guardian_name" value="{{ student.guardian_name if is_edit else '' }}">
    </div>
    <div class="col-md-4">
      <label class="form-label" for="guardian_phone">监护人电话</label>
      <input type="text" class="form-control" id="guardian_phone" name="guardian_phone" value="{{ student.guardian_phone if is_edit else '' }}">
    </div>
    <div class="col-md-6">
      <label class="form-label" for="address">联系地址</label>
      <textarea class="form-control" id="address" name="address" rows="2">{{ student.address if is_edit else '' }}</textarea>
    </div>
    <div class="col-md-6">
      <label class="form-label" for="avatar">头像</label>
      <input type="file" class="form-control" id="avatar" name="avatar">
      {% if is_edit and student.avatar_path %}
        <div class="form-text">当前头像：{{ student.avatar_path }}</div>
      {% endif %}
    </div>
    <div class="col-12">
      <button type="submit" class="btn btn-primary">{{ '保存修改' if is_edit else '保存' }}</button>
      <a class="btn btn-link" href="{{ url_for('students.list_students') }}">取消</a>
    </div>
  </form>
{% endblock %}
